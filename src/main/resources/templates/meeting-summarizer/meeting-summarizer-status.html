<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Meeting Summary Status</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" th:href="@{/css/style.css}" href="/css/style.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
  <script src="https://kit.fontawesome.com/4b8b0b6b0b.js" crossorigin="anonymous"></script>
  <style>
    html, body {
      background-color: #f5f5f5;
    }
    .box, .notification, .card {
      background-color: #fff;
      color: #222;
    }
    [data-theme="dark"] html, [data-theme="dark"] body {
      background-color: #222 !important;
    }
    [data-theme="dark"] .box, [data-theme="dark"] .notification, [data-theme="dark"] .card {
      background-color: #2a2a2a !important;
      color: #f5f5f5 !important;
    }
    pre {
      background: #23272e;
      color: #f5f5f5;
      border-radius: 6px;
      padding: 1rem;
      white-space: pre-wrap;
    }
    [data-theme="light"] pre {
      background: #f4f4f4;
      color: #222;
    }
  </style>
</head>
<body>
<div th:replace="fragments/darkmode-toggle :: darkModeToggle"></div>
<section class="section is-medium has-background-light" style="min-height: 90vh;">
  <div class="container" style="max-width: 700px;">
    <div class="box mt-6">
      <h2 class="title is-3 has-text-link has-text-centered mb-4">Meeting Summary Status</h2>
      <div class="subtitle is-5 has-text-centered mb-3">Track your meeting's progress and view the summary below.</div>

      <!-- Status Notification -->
      <div th:if="${job.status == 'IN_PROGRESS'}" class="notification is-warning has-text-centered mb-4">
        <span class="icon-text">
          <span class="icon"><i class="fas fa-spinner fa-spin"></i></span>
          <span><strong>Status:</strong> <span th:text="${job.status}">Loading...</span></span>
        </span>
        <progress class="progress is-small is-warning mt-2" max="100">Loading‚Ä¶</progress>
        <p class="has-text-grey mt-2">‚è≥ Your meeting is being processed. Please wait...</p>
        <script>setTimeout(() => location.reload(), 5000);</script>
      </div>
      <div th:if="${job.status == 'COMPLETED'}" class="notification is-success has-text-centered mb-4">
        <span class="icon-text">
          <span class="icon"><i class="fas fa-check-circle"></i></span>
          <span><strong>Status:</strong> <span th:text="${job.status}">Completed</span></span>
        </span>
      </div>
      <div th:if="${job.status == 'FAILED'}" class="notification is-danger has-text-centered mb-4">
        <span class="icon-text">
          <span class="icon"><i class="fas fa-exclamation-triangle"></i></span>
          <span><strong>Status:</strong> <span th:text="${job.status}">Failed</span></span>
        </span>
      </div>

      <!-- Show final summary -->
      <div th:if="${job.status == 'COMPLETED'}">
        <div class="subtitle is-6 has-text-centered mb-2">Here is your meeting summary:</div>
        <pre class="content" th:text="${job.summaryText}">No summary available.</pre>
      </div>

      <!-- Show error -->
      <div th:if="${job.status == 'FAILED'}" class="notification is-danger mt-4">
        <span class="icon-text">
          <span class="icon"><i class="fas fa-exclamation-triangle"></i></span>
          <span><strong>Error:</strong> <span th:text="${job.errorMessage}">Something went wrong.</span></span>
        </span>
      </div>

      <div class="has-text-centered mt-5">
        <a href="/meeting-summarizer" class="button is-link is-medium is-fullwidth" style="white-space: normal;">
          <span class="icon"><i class="fas fa-upload"></i></span>
          <span>Upload Another Meeting</span>
        </a>
      </div>
    </div>
  </div>
</section>
<footer class="footer mt-6">
  <div class="content has-text-centered">
    <p>
      <a href="/terms">Terms of Service</a> |
      <a href="/privacy">Privacy Policy</a> |
      <a href="/disclaimer">Disclaimer</a> |
      <a href="/contact" aria-label="Send Feedback">üí¨ Send Feedback</a> |
      <a href="/blog">Blog</a>
    </p>
    <p class="is-size-7 has-text-grey mt-4">
      ¬© 2025 NovaSyntax LLC. All rights reserved.
    </p>
  </div>
</footer>
</body>
</html>
